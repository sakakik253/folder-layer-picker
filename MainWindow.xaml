<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Folder Layer Picker" Height="700" Width="800"
        WindowStartupLocation="CenterScreen">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- セクション1: 対象フォルダ選択 -->
        <GroupBox Header="対象フォルダ選択" Grid.Row="0" Margin="0,0,0,10" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox Name="txtFolderPath" Grid.Column="0" VerticalContentAlignment="Center" Height="30" IsReadOnly="True"/>
                <Button Name="btnBrowse" Content="参照" Grid.Column="1" Width="80" Height="30" Margin="5,0,0,0"/>
            </Grid>
        </GroupBox>

        <!-- セクション2: 階層構造の分析 -->
        <GroupBox Header="階層構造の分析" Grid.Row="1" Margin="0,0,0,10" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <Button Name="btnAnalyze" Content="分析" Width="100" Height="30" HorizontalAlignment="Left" Margin="0,0,0,10"/>
                    <TextBlock Name="txtAnalysisStatus" Text="フォルダを選択して「分析」ボタンをクリックしてください。" 
                               Foreground="Gray" Margin="0,0,0,5"/>
                </StackPanel>
                
                <Button Name="btnExportAnalysis" Content="分析結果をエクスポート" Width="160" Height="30" 
                        Grid.Column="1" IsEnabled="False" VerticalAlignment="Top"
                        ToolTip="テキストとCSV形式で分析結果を出力します"/>
            </Grid>
        </GroupBox>

        <!-- セクション3: 操作設定と階層選択 -->
        <GroupBox Header="操作設定" Grid.Row="2" Margin="0,0,0,10" Padding="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- 操作モード選択 -->
                <StackPanel Grid.Row="0" Margin="0,0,0,10">
                    <TextBlock Text="操作モード:" FontWeight="Bold" Margin="0,0,0,5"/>
                    <StackPanel Orientation="Horizontal" Margin="10,0,0,0">
                        <RadioButton Name="rdoMoveAndDeleteAll" Content="移動＋空フォルダ全削除" GroupName="OperationMode" 
                                     IsChecked="True" Margin="0,0,15,0" VerticalAlignment="Center"/>
                        <RadioButton Name="rdoMoveOnly" Content="移動のみ" GroupName="OperationMode" 
                                     Margin="0,0,15,0" VerticalAlignment="Center"/>
                        <RadioButton Name="rdoDeleteOnly" Content="削除のみ" GroupName="OperationMode" 
                                     Margin="0,0,15,0" VerticalAlignment="Center"/>
                        <RadioButton Name="rdoCustom" Content="カスタム" GroupName="OperationMode" 
                                     VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Name="txtModeDescription" Text="選択した階層のフォルダをルート直下に移動し、すべての空フォルダを削除します。" 
                               Foreground="Gray" FontSize="10" Margin="10,5,0,0"/>
                </StackPanel>
                
                <!-- 階層選択エリア -->
                <Grid Grid.Row="1" Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- 左側: 移動する階層 -->
                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <TextBlock Name="lblMoveLayersTitle" Text="移動する階層を選択（複数可）:" FontWeight="Bold" Margin="0,0,0,5"/>
                        <Border BorderBrush="LightGray" BorderThickness="1" Padding="5" Background="White" MinHeight="100">
                            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="130">
                                <StackPanel Name="pnlMoveLayerSelection">
                                    <TextBlock Text="（分析後に表示されます）" Foreground="Gray"/>
                                </StackPanel>
                            </ScrollViewer>
                        </Border>
                        
                        <!-- 移動先選択 -->
                        <StackPanel Name="pnlMoveDestination" Margin="0,8,0,0" Visibility="Collapsed">
                            <TextBlock Text="移動先:" FontWeight="Bold" Margin="0,0,0,3"/>
                            <RadioButton Name="rdoMoveToRoot" Content="ルート直下に移動" GroupName="MoveDestination" 
                                         IsChecked="True" Margin="5,0,0,2"/>
                            <RadioButton Name="rdoMoveToParent" Content="1階層上に移動" GroupName="MoveDestination" 
                                         Margin="5,0,0,0"/>
                        </StackPanel>
                        
                        <!-- 削除オプション（カスタムモード時のみ） -->
                        <StackPanel Name="pnlDeleteOptions" Margin="0,8,0,0" Visibility="Collapsed">
                            <TextBlock Text="削除オプション:" FontWeight="Bold" Margin="0,0,0,3"/>
                            <RadioButton Name="rdoDeleteAllEmpty" Content="すべての空フォルダ" GroupName="DeleteRange" 
                                         IsChecked="True" Margin="5,0,0,2"/>
                            <RadioButton Name="rdoDeleteSelectedOnly" Content="選択階層のみ" GroupName="DeleteRange" 
                                         Margin="5,0,0,2"/>
                            <RadioButton Name="rdoNoDelete" Content="削除しない" GroupName="DeleteRange" 
                                         Margin="5,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- 右側: プレビュー要約 -->
                    <StackPanel Grid.Column="1">
                        <TextBlock Text="実行後の予測:" FontWeight="Bold" Margin="0,0,0,5"/>
                        <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Background="#F5F5F5" MinHeight="80">
                            <StackPanel>
                                <TextBlock Name="txtPreviewMoveCount" Text="移動されるフォルダ数: -" 
                                           Margin="0,0,0,3" TextWrapping="Wrap"/>
                                <TextBlock Name="txtPreviewDeleteCount" Text="削除される空フォルダ数: -" 
                                           Margin="0,0,0,3" TextWrapping="Wrap"/>
                                <TextBlock Name="txtPreviewStatus" Text="プレビューを更新してください。" 
                                           Foreground="Gray" FontStyle="Italic" Margin="0,3,0,0" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>
                        <Button Name="btnUpdatePreview" Content="プレビュー更新" Width="120" Height="28" 
                                IsEnabled="False" Margin="0,8,0,0" HorizontalAlignment="Left"/>
                    </StackPanel>
                </Grid>
                
                <!-- プレビュー詳細（全幅） -->
                <GroupBox Header="プレビュー詳細" Grid.Row="2" Padding="5">
                    <TextBox Name="txtPreviewDetails" IsReadOnly="True" 
                             VerticalScrollBarVisibility="Auto" 
                             HorizontalScrollBarVisibility="Auto" 
                             FontFamily="Consolas" FontSize="10"
                             Text="プレビューを更新すると、ここに詳細が表示されます。"
                             MinHeight="150"/>
                </GroupBox>
            </Grid>
        </GroupBox>

        <!-- セクション4: オプション -->
        <GroupBox Header="オプション" Grid.Row="3" Margin="0,0,0,10" Padding="10">
            <StackPanel>
                <CheckBox Name="chkCreateBackup" Content="実行前にバックアップを作成する（推奨）" IsChecked="True"/>
                <TextBlock Text="※バックアップは元のフォルダと同じ場所に「_backup_タイムスタンプ」形式で作成されます。" 
                           Foreground="Gray" FontSize="10" Margin="20,5,0,0"/>
            </StackPanel>
        </GroupBox>

        <!-- セクション5: 実行状態 -->
        <GroupBox Header="実行状態" Grid.Row="4" Margin="0,0,0,10" Padding="10">
            <StackPanel>
                <TextBlock Name="txtExecutionStatus" Text="待機中..." Foreground="Blue"/>
                <ProgressBar Name="progressBar" Height="20" Margin="0,5,0,0" Minimum="0" Maximum="100" Value="0" Visibility="Collapsed"/>
            </StackPanel>
        </GroupBox>

        <!-- セクション6: ボタン -->
        <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Name="btnExecute" Content="実行" Width="100" Height="35" Margin="0,0,10,0" IsEnabled="False"
                    Background="#4CAF50" Foreground="White" FontWeight="Bold"/>
            <Button Name="btnUndo" Content="元に戻す" Width="100" Height="35" Margin="0,0,10,0" IsEnabled="False"/>
            <Button Name="btnClose" Content="閉じる" Width="100" Height="35"/>
        </StackPanel>

        <!-- ステータスバー -->
        <StatusBar Grid.Row="6" Margin="-10,10,-10,-10">
            <StatusBarItem>
                <TextBlock Name="txtStatusBar" Text="準備完了"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>

